name: CI


on:
push:
branches: [ main, master ]
pull_request:
branches: [ main, master ]


jobs:
build-and-test:
runs-on: ubuntu-latest
strategy:
matrix:
python-version: [3.8, 3.9, 3.10, 3.11]
steps:
- name: Checkout
uses: actions/checkout@v4


- name: Setup Python
uses: actions/setup-python@v4
with:
python-version: ${{ matrix.python-version }}


- name: Cache pip
uses: actions/cache@v4
with:
path: ~/.cache/pip
key: ${{ runner.os }}-pip-${{ matrix.python-version }}-${{ hashFiles('**/requirements.txt') }}
restore-keys: |
${{ runner.os }}-pip-${{ matrix.python-version }}-


- name: Install dependencies
run: |
python -m pip install --upgrade pip
pip install -r requirements-dev.txt


- name: Lint (optional)
run: |
if command -v flake8 >/dev/null 2>&1; then
flake8 . || true
fi


- name: Run unit tests
run: |
pytest -q


- name: Upload test results
if: always()
uses: actions/upload-artifact@v4
with:
name: pytest-results-${{ matrix.python-version }}
path: .pytest_cache || .


build-docs:
runs-on: ubuntu-latest
needs: build-and-test
steps:
- name: Checkout
uses: actions/checkout@v4
- name: Build docs (placeholder)
run: |
echo "No docs builder yet. Add Sphinx/MDBook in future."
- name: Upload docs
if: always()
uses: actions/upload-artifact@v4
with:
name: docs
path: .
